{{ if .Vars.rhel8cis_auditd }}
package:
  {{ if .Vars.rhel8cis_rule_4_1_1_1 }}
  audit:
    title: (L2) 4.1.1.1 Ensure auditd is installed (Automated)
    installed: true
  audit-libs:
    title: 4.1.1.1 Ensure auditd is installed (Automated)
    installed: true
  {{ end }}
{{ end }}
{{ if .Vars.rhel8cis_rule_4_1_1_2 }}
service:
  auditd:
    title: (L2) 4.1.1.2 Ensure auditd service is enabled and running (Automated)
    enabled: true
    running: true
{{ end }}
{{ if .Vars.rhel8cis_rule_4_1_1_3 }}
file:
  /etc/grub2/grubenv:
    title: (L2) 4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled (Automated)
    exists:  true
    contains: 
    - '/?=\S+\s(audit=1.*)$)^kernelopts="/'
  /etc/default/grub:
    title: (L2) 4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled (Automated)
    exists:  true
    contains: 
    - '/?=\S+\s(audit=1.*)$)^GRUB_CMDLINE_LINUX="/'
{{ end }}
{{ if .Vars.rhel8cis_rule_4_1_1_4 }}
file:
  /boot/grub2/grubenv:
    title: (L2) 4.1.1.4 Ensure audit_backlog_limit is sufficient
    exists:  true
    contains: 
    - '/?=\S+\s(audit_backlog_limit=.*)$)^kernelopts="/'
  /etc/default/grub:
    title: (L2) 4.1.1.4 Ensure audit_backlog_limit is sufficient
    exists:  true
    contains: 
    - '/?=\S+\s(audit_backlog_limit=.*)$)^GRUB_CMDLINE_LINUX="/'
{{ end }}
